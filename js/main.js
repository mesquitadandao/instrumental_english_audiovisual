$(function(){var a=$("#start-now"),t=$("#your-text"),n=$("#your-language"),l=($("#your-vocabulary-div"),$("#your-vocabulary-body")),e=$("#to"),o=[],s=null,i=!0,r=null,d=$("#progress-translation"),c=$("#error-translation"),u="glyphicon-play",p="glyphicon-stop",y="glyphicon-volume-up",v=function(){$(".play").off("click.play").on("click.play",function(){var a=$(this),t=a.data("index"),n=a.data("key"),l=a.closest("td");i&&a.removeClass("play");var e=$(".play, #play-origin, #play-translation, #play-all, #start-now");e.attr("disabled","disabled"),l.addClass("success"),a.removeClass(u).addClass(i?p:y),o[t][n].audio instanceof HTMLAudioElement||(o[t][n].audio=o[t][n].audio());var d=o[t][n].audio;if(d.playing)d.stop();else{var c=o[t][n].next||function(){};d.onended=c instanceof h?function(){a.removeClass(i?p:y).addClass(u),l.removeClass("success"),e.attr("disabled",null),i&&a.addClass("play"),this.playing=!1,c.exec()}:function(){a.removeClass(i?p:y).addClass(u),l.removeClass("success"),e.attr("disabled",null),i&&a.addClass("play"),this.playing=!1,c()},d.onerror=function(){this.hasError=!0,l.addClass("danger"),this.onended()},r=d,d.play(s)}})},h=function(a){var t=a;this.exec=function(){t.click()}},f=function(a){$("#play-"+a).off("click.play").on("click.play",function(){var t=$(this);if(i){for(var n=$(".play[data-key="+a+"]"),l=0;l<o.length-1;l++){var e=n[l+1];o[l][a].next=new h(e)}var e=n[0];o[o.length-1][a].next=new h(e),n[0]&&(s=$("#play-"+a+"-repeat").val(),t.attr("id",null),t.removeClass(u).addClass(p),i=!1,n[0].click())}else{for(var l=0;l<o.length;l++)o[l][a].next=null;t.attr("id","play-"+a),t.removeClass(p).addClass(u),r.stop(),r.onended(),i=!0,s=null}})},g=function(){$("#play-all").off("click.play").on("click.play",function(){var a=$(this);if(i){for(var t=$(".play[data-key=origin]"),n=$(".play[data-key=translation]"),l=($("#play-origin, #play-translation"),0);l<o.length-1;l++){var e=n[l];o[l].origin.next=new h(e);var d=t[l+1];o[l].translation.next=new h(d)}var e=n[o.length-1];o[o.length-1].origin.next=new h(e);var d=t[0];o[o.length-1].translation.next=new h(d),t[0]&&(s=$("#play-all-repeat").val(),a.attr("id",null),a.removeClass(u).addClass(p),i=!1,t[0].click())}else{for(var l=0;l<o.length;l++)o[l].origin.next=null,o[l].translation.next=null;a.attr("id","play-all"),a.removeClass(p).addClass(u),r.stop(),r.onended(),i=!0,s=null}})};MDTranslator.prototype.completed=function(n){if(d.addClass("hidden"),a.attr("disabled",!1),n.length>0){o=n;for(var e=0;e<o.length;e++)l.append('<tr><td><h6><button class="btn btn-default btn-sm glyphicon '+u+' play" data-index="'+e+'" data-key="origin"></button> '+o[e].origin.text+'</h6></td><td><h6><button class="btn btn-default btn-sm glyphicon '+u+' play" data-index="'+e+'" data-key="translation"></button> '+o[e].translation.text+"</h6></td><tr>");v(),f("origin"),f("translation"),g(),t.val(""),location.hash="#to"}else{var s=c.clone();s.removeClass("hidden"),s.appendTo(c.parent())}},$("#form-your-text").on("submit.generate-your-vacabulary",function(){$("#myModal").modal("hide"),l.empty(),d.removeClass("hidden"),a.attr("disabled",!0);var e=t.val().extractUniqueWordsEnglish();MDT.words(e).to(n.data("selected").data("code"))}),$("input[type=number]").mask("9"),$(".language").on("click",function(){var a=$(this),t=n.data("selected");n.data("selected",a),a.addClass("hidden"),t&&t.removeClass("hidden"),n.val($(this).text()),e.text($(this).text())});var m="http://www.microsofttranslator.com";location&&location.href&&0==location.href.indexOf("https")&&(m="https://ssl.microsofttranslator.com"),m+="/ajax/v3/WidgetV3.ashx?siteData=ueOIGRSKkd965FeEGM5JtQ**&ctf=False&ui=true&settings=Auto&from=en",$.getScript(m,function(){$(".language[data-code=pt]")[0].click(),$("#start-now").attr("disabled",null)})});